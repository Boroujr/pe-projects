<%- include('partials/header.ejs') %>
<%
	function findDigimon(id) {
		return monsters.find(function (monster) {
			return monster.id == id || monster.name.toLowerCase() == id;
		});
	}
%>


<inner-column>
	<h1 class="loud-voice"><%=monster.name%></h1>
	<graphic-description>
		<p>
			<%=monster.descriptions[0].description%>
		</p>
		<picture>
			<img src="<%=monster.images[0].href%>">
		</picture>
		<data-module>
		<ul>
			<li>
				Digilevel: <%=monster.levels[0].level%>
			</li>
			<li>
				Type: <%=monster.types[0].type%>
			</li>
			<li>
				Attribute: <%=monster.attributes[0].attribute%>
			</li>
			<% monster.fields.forEach(function (field) { %>
					<li class="field">
						<picture>
						<img src="https://digimon-api.com/images/etc/fields/<%=field.field%>.png">
					</picture>
					</li>
			<% }) %>
		</ul>
	</data-module>
	</graphic-description>
	
	<skill-list>
		<h3 class="attention-voice">skills</h3>
		<ul>
			<% monster.skills.forEach(function(skill) { %>
				<li><%=skill.skill%></li>
			<% }) %>
		</ul>
	</skill-list>
	<evolution-list>
		<prior-forms>
			<h3 class="attention-voice">Prior forms</h3>
		<ul>
			<% 
				monster.priorEvolutions.forEach(function(priorEvolution) { 
					let digimon = findDigimon(priorEvolution.id);
					if (!digimon) return;
				%>
					<li>
						<a href="<%=digimon.name%>">
							<monster-card>
								<picture>
								<img src="<%=digimon.images[0].href%>">
							</picture>
							</monster-card>
						</a>
					</li>
			<% }) %>
		</ul>
		</prior-forms>
		<next-forms>
			<h3 class="attention-voice">Next forms</h3>
		<ul>
			<% 
				monster.nextEvolutions.forEach(function(nextEvolution) {
				
					let digimon = findDigimon(nextEvolution.id);
					if (!digimon) return;

					let condition = nextEvolution.condition 
										? 'has-condition' 
										: ""; 
				%>
					<li>
						<a href="<%=digimon.name%>">
							<monster-card class="<%=condition%>">
							<picture>
							<img src="<%=digimon.images[0].href%>">
						</picture>
						</monster-card>
						</a>
					</li>
			<% }) %>
		</ul>
		</next-forms>
	</evolution-list>
</inner-column>

<%- include('partials/footer.ejs') %>
